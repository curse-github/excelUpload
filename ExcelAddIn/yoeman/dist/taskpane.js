!function(){var t={14183:function(){var t=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{c(r.next(t))}catch(t){o(t)}}function u(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,u)}c((r=r.apply(t,e||[])).next())}))},e=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(u){return function(c){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&u[0]?r.return:u[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,u[1])).done)return i;switch(r=0,i&&(u=[2&u[0],i.value]),u[0]){case 0:case 1:i=u;break;case 4:return s.label++,{value:u[1],done:!1};case 5:s.label++,r=u[1],u=[0];continue;case 7:u=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==u[0]&&2!==u[0])){s=0;continue}if(3===u[0]&&(!i||u[1]>i[0]&&u[1]<i[3])){s.label=u[1];break}if(6===u[0]&&s.label<i[1]){s.label=i[1],i=u;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(u);break}i[2]&&s.ops.pop(),s.trys.pop();continue}u=e.call(t,s)}catch(t){u=[6,t],r=0}finally{n=i=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}};Office.onReady((function(){var n=this;$(document).ready((function(){return t(n,void 0,void 0,(function(){return e(this,(function(t){return $("#get").on("click",u),[2]}))}))}))}));var n=function(){function n(t){this.address="",this.context=t}return n.prototype.update=function(){return t(this,void 0,void 0,(function(){var n=this;return e(this,(function(r){return[2,new Promise((function(r){return t(n,void 0,void 0,(function(){return e(this,(function(t){switch(t.label){case 0:return null==this.range?(r(),[2]):(this.range.load("address"),[4,this.context.sync()]);case 1:return t.sent(),this.address=this.range.address,r(),[2]}}))}))}))]}))}))},n.prototype.getSelectedRange=function(){return this.range=this.context.workbook.getSelectedRange(),this},n.prototype.setValues=function(t){return null==this.range||(this.range.values=t),this},n.prototype.getValues=function(){return t(this,void 0,void 0,(function(){var n=this;return e(this,(function(r){return[2,new Promise((function(r){return t(n,void 0,void 0,(function(){return e(this,(function(t){switch(t.label){case 0:return this.range.load("values"),[4,this.context.sync()];case 1:return t.sent(),null==this.range?(r([]),[2]):(r(this.range.values),[2])}}))}))}))]}))}))},n.prototype.getText=function(){return t(this,void 0,void 0,(function(){var n=this;return e(this,(function(r){return[2,new Promise((function(r){return t(n,void 0,void 0,(function(){return e(this,(function(t){switch(t.label){case 0:return this.range.load("text"),[4,this.context.sync()];case 1:return t.sent(),null==this.range?(r([]),[2]):(r(this.range.text),[2])}}))}))}))]}))}))},n.prototype.setFill=function(t){return null==this.range||(this.range.format.fill.color=t),this},n.prototype.clearFill=function(){return null==this.range||this.range.format.fill.clear(),this},n}();function r(){return t(this,void 0,void 0,(function(){var n=this;return e(this,(function(r){return[2,new Promise((function(r){Excel.run((function(i){return t(n,void 0,void 0,(function(){return e(this,(function(t){return r(i),[2]}))}))}))}))]}))}))}function i(n,r,i){return t(this,void 0,void 0,(function(){var t;return e(this,(function(e){return(t=i||{})["Content-Type"]="application/json",[2,new Promise((function(e){fetch(n,{method:"POST",mode:"no-cors",headers:t,body:JSON.stringify(r)}).then((function(t){return t.text()})).then((function(t){return e(t)}))}))]}))}))}function o(n){return t(this,void 0,void 0,(function(){return e(this,(function(t){return[2,new Promise((function(t){crypto.subtle.digest("SHA-256",(new TextEncoder).encode(n)).then((function(e){for(var n="",r=new DataView(e),i=0;i<r.byteLength;i+=4)n+=("00000000"+r.getUint32(i).toString(16)).slice(-8);t(n)}))}))]}))}))}var s=500;function u(){return t(this,void 0,void 0,(function(){var t,u,c,a,l,f,h,d,p,g,v,y,b,w,m,x;return e(this,(function(e){switch(e.label){case 0:return e.trys.push([0,13,,14]),[4,r()];case 1:return t=e.sent(),u=new n(t).getSelectedRange(),(c=document.getElementById("bar")).setAttribute("style","--percent:0%"),(a=document.getElementById("status")).innerText="Processing.",[4,u.getText()];case 2:return l=e.sent(),console.log("Transfering "+l.length+" lines."),a.innerText="Sending...",l.length<=s?(f=(new Date).getTime(),[4,i("http://localhost:3000/wholeTransfer",{data:l,start:f},{})]):[3,4];case 3:return e.sent(),a.innerText="Success!",[3,12];case 4:return h=(new Date).getTime(),[4,o(JSON.stringify(l))];case 5:return d=e.sent(),v=(g=JSON).parse,[4,i("http://localhost:3000/startTransfer",{sha:d,start:h},{})];case 6:p=v.apply(g,[e.sent()]).id,y=[],b=0,e.label=7;case 7:return b<l.length?(y.push(l[b]),y.length!=s&&b!=l.length-1?[3,9]:[4,i("http://localhost:3000/transfer?id="+p,y,{})]):[3,10];case 8:e.sent(),c.setAttribute("style","--percent:"+(100*(b+1)/l.length).toString()+"%"),y=[],e.label=9;case 9:return b++,[3,7];case 10:return x=(m=JSON).parse,[4,i("http://localhost:3000/endTransfer?id="+p,{},{})];case 11:w=x.apply(m,[e.sent()]).status,console.log(w?"success":"fail"),a.innerText=w?"Success!":"Fail.",console.log("Time to send: "+((new Date).getTime()-h)),e.label=12;case 12:return c.setAttribute("style","--percent:100%"),[3,14];case 13:return e.sent(),[3,14];case 14:return[2]}}))}))}},93823:function(t,e,n){"use strict";var r=n(27091),i=n.n(r),o=new URL(n(60806),n.b);i()(o)},27091:function(t){"use strict";t.exports=function(t,e){return e||(e={}),t?(t=String(t.__esModule?t.default:t),e.hash&&(t+=e.hash),e.maybeNeedQuotes&&/[\t\n\f\r "'=<>`]/.test(t)?'"'.concat(t,'"'):t):t}},60806:function(t,e,n){"use strict";t.exports=n.p+"d916c354314f23a46dd2.css"}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var o=e[r]={exports:{}};return t[r].call(o.exports,o,o.exports,n),o.exports}n.m=t,n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,{a:e}),e},n.d=function(t,e){for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},function(){var t;n.g.importScripts&&(t=n.g.location+"");var e=n.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var r=e.getElementsByTagName("script");if(r.length)for(var i=r.length-1;i>-1&&!t;)t=r[i--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=t}(),n.b=document.baseURI||self.location.href,n(14183),n(93823)}();
//# sourceMappingURL=taskpane.js.map